<div class="container">
  <app-title title="Envio de Solicitações"></app-title>

  <form [formGroup]="form">

    <div class="form-group">
      <label for="tipoSolicitacao">Tipo:</label>
      <select name="tipoSolicitacao" id="tipoSolicitacao" formControlName="tipoSolicitacao" (change)="selectTipo($event)" required>
        <option value="" [disabled]="isTipoSolicitacaoSelected()">Selecione o tipo de solicitação</option>
        <option *ngFor="let item of listTiposRequisicoes" [ngValue]="item.tipoSolicitacao">
          {{ item.tipoSolicitacao }}
        </option>
      </select>
    </div>

    <div [ngSwitch]="tipoSolicitacao">
      <div *ngSwitchCase="'CERTIFICACAO'">
        <div class="form-group">
          <label for="componenteCurricular">Componente Curricular:</label>
          <select name="componenteCurricular" id="componenteCurricular" formControlName="disciplina_id" required>
            <option *ngFor="let item of listDisciplinas" [ngValue]="item.id">
              {{ item.nome }}
            </option>
          </select>
          <span class="alert" *ngIf=" !isValid('disciplina_id') && form.get('experienciasAnteriores')?.hasError('required') && form.get('experienciasAnteriores')?.touched">
            Componente Curricular é obrigatório!
          </span>
        </div>
        
  <div class="form-group">
    <label for="experienciaAnterior">Experiência anterior:</label>
    <input type="text" name="experienciaAnterior" id="experienciaAnterior" placeholder="ex: atuação em projeto que utiliza angular" 
    formControlName="experienciasAnteriores" [required]="!isAproveitamento()"/>
    <span class="alert" *ngIf="form.get('experienciasAnteriores')?.hasError('required') && form.get('experienciasAnteriores')?.touched">
      Este campo é obrigatório.
    </span>
    <span class="alert" *ngIf=" check('experienciasAnteriores', 'minLength') ">
      Mínimo 6 caracteres!
    </span>
    <span class="alert" *ngIf=" check('experienciasAnteriores', 'maxLength') ">
      Máximo 120 caracteres!
    </span>
    <span class="alert" *ngIf=" check('experienciasAnteriores', 'status') && form.get('experienciasAnteriores')?.touched 
      && !check('experienciasAnteriores', 'minLength') && !form.get('experienciasAnteriores')?.hasError('required')">
      Contém caracter inválido! Use somente letras, números e ponto final.
    </span>
  </div>

        <div class="form-group">
          <label for="file-input">Anexar arquivo:</label>
          <div class="file-upload">
            <label for="file-input" class="file-label" [innerHTML]="fileFormat"></label>
            <input type="file" id="file-input" class="file-input" accept=".pdf, .jpeg" multiple (change)="handleFileSelect($event)"/>
          </div>
          <div class="file-info" *ngFor="let file of files; let i = index">
            <span>{{ file.name }}</span>
            <button class="btn-remove" (click)="removeFile(i)">(remover)</button>
          </div>
        </div>

        <br/><br/>

        <div class="form-half-grid">
          <div class="btn-submit-container">
            <button type="submit" class="btn-register" (click)="submitForm()" 
            [ngClass]="{'btn-green': form.valid , 'btn-gray': !form.valid }" [disabled]="!form.valid">Enviar</button>
          </div>
          <div class="btn-submit-container">
            <button type="reset" class="btn-register btn-red" (click)="handleResetClick()">Cancelar</button>
          </div>
        </div>
      </div>
      
      <div *ngSwitchCase="'APROVEITAMENTO'">
        <div class="form-group">
          <label for="componenteCurricular">Componente Curricular:</label>
          <select name="componenteCurricular" id="componenteCurricular" formControlName="disciplina_id" required>
            <option *ngFor="let item of listDisciplinas" [ngValue]="item.id">
              {{ item.nome }}
            </option>
          </select>
          <span class="alert" *ngIf=" !isValid('disciplina_id') && form.get('diciplinaCursaAnteriormente')?.hasError('required') 
          && form.get('diciplinaCursaAnteriormente')?.touched ">
            Componente Curricular é obrigatório!
          </span>
        </div>

  <div class="form-group">
    <label for="componenteCursado">Componente cursado anteriormente:</label>
    <input type="text" name="componenteCursado" id="componenteCursado" placeholder="Nome do curso frequentado" 
      formControlName="diciplinaCursaAnteriormente" [required]="!isCertificacao()"/>
    <span class="alert" *ngIf="form.get('diciplinaCursaAnteriormente')?.hasError('required') 
      && form.get('diciplinaCursaAnteriormente')?.touched">
      Este campo é obrigatório.
    </span>
    <span class="alert" *ngIf=" check('diciplinaCursaAnteriormente', 'minLength') ">
      Mínimo 6 caracteres!
    </span>
    <span class="alert" *ngIf=" check('diciplinaCursaAnteriormente', 'maxLength') ">
      Máximo 120 caracteres!
    </span>
    <span class="alert" *ngIf=" check('diciplinaCursaAnteriormente', 'status') && form.get('diciplinaCursaAnteriormente')?.touched 
      && !check('diciplinaCursaAnteriormente', 'minLength') && !form.get('diciplinaCursaAnteriormente')?.hasError('required')">
      Contém caracter inválido! Use somente letras, números e ponto final.
    </span>
  </div>

  <div class="form-half-grid">
    <div class="form-group">
      <label for="nota">Nota obtida:</label>
      <input type="number" name="nota" id="nota" min="0" max="10" step="0.1" placeholder="Inserir nota" formControlName="notaObtida" required>
      <span class="alert" *ngIf=" !isValid('notaObtida') && form.get('notaObtida')?.dirty ">
        Inválida. Use valor até 10.0
      </span>
      <span class="alert" *ngIf=" form.get('notaObtida')?.hasError('required') && form.get('notaObtida')?.touched ">
        Este campo é obrigatório.
      </span>
    </div>
    <div class="form-group">
      <label for="cargaHoraria">Carga Horária</label>
      <input type="number" id="cargaHoraria" name="cargaHoraria" placeholder="Carga Horária(h)" min="0" formControlName="cargaHoraria" required />
    <span class="alert" *ngIf=" !isValid('cargaHoraria') && form.get('cargaHoraria')?.dirty ">
      Inválida. Use valor entre 1 e 1000 horas
    </span>
    <span class="alert" *ngIf=" form.get('cargaHoraria')?.hasError('required') && form.get('cargaHoraria')?.touched ">
      Este campo é obrigatório.
    </span>
      </div>
  </div>

  <div class="form-group">
    <label for="file-input">Anexar arquivo:</label>
      <div class="file-upload">
        <label for="file-input" class="file-label" [innerHTML]="fileFormat"></label>
          <input type="file" id="file-input" class="file-input" accept=".pdf, .jpeg" multiple (change)="handleFileSelect($event)"/>
        </div>
      <div class="file-info" *ngFor="let file of files; let i = index">
      <span>{{ file.name }}</span>
      <button class="btn-remove" (click)="removeFile(i)">(remover)</button>
    </div>
  </div>

  <br/><br/>

  <div class="form-half-grid">
    <div class="btn-submit-container">
      <button type="submit" class="btn-register"
        (click)="submitForm()"[ngClass]="{'btn-green': form.valid , 'btn-gray': !form.valid }" [disabled]="!form.valid">Enviar</button>
    </div>
     <div class="btn-submit-container">
        <button type="reset" class="btn-register btn-red" (click)="handleResetClick()">Cancelar</button>
      </div>
    </div>
  </div>
    <div *ngSwitchDefault>
       <!-- Conteúdo padrão quando 'tipoSolicitacao' não corresponde a 'certificacao' ou 'aproveitamento' -->
    </div>
  </div>

  </form>
</div>
