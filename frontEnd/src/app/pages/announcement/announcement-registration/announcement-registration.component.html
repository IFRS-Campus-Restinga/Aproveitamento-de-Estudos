<div class="container">
  <app-title title="Cadastrar Edital"></app-title>
  <form [formGroup]="form">

    <div class="form-group">
      <label for="numero">Número do edital</label>
      <input type="text" id="numero"formControlName="numero" placeholder="" (blur)="convertNumeroToUpperCase()"
      [ngClass]="{'valid-input': isNumeroValid(), 'invalid-input': !isNumeroValid()}"/>
    </div>

    <div class="form-half-grid">
      <div class="form-group">
        <label for="coordenador">Data Início</label>
        <input type="date" id="dataInicio" formControlName="dataInicio"
        [ngClass]="{'valid-input': validarDataFinalPosterior(),
         'invalid-input': !validarDataFinalPosterior()}" />
        </div>

        <div class="form-group">
        <label for="coordenador">Data Fim</label>
        <input type="date" id="dataFim" formControlName="dataFim"
        [ngClass]="{'valid-input': validarDataFinalPosterior(),
        'invalid-input': !validarDataFinalPosterior()}" />
        </div>
      </div>

      <div class="btn-container">
          <h3>Etapas:</h3>
          <button (click)="addStep()" class="btn-register add-step">Etapa +</button>
      </div>
      <div class="form-group">
        <table formArrayName="etapas" *ngFor="let step of getStepsFormArray(); let i = index">
          <div class="step-container">
            <tr class="grid-step" [formGroupName]="i">
              <td>
                <label for="nome">Descrição</label>
                <input type="text" id="nome" name="nome" formControlName="nome" placeholder=""
                [ngClass]="{'valid-input': isNomeValid(), 'invalid-input': !isNomeValid()}"/>
              </td>

              <td>
                <label for="ator">Ator</label>
                <select id="ator" formControlName="ator" [class.invalid]="!isAtorValid()">
                <option value="">Selecione um ator</option>
                <option *ngFor="let ator of listAtores" [value]="ator.ator">{{ ator.ator }}</option>
                </select>
              </td>

            </tr>
              <tr class="grid-step" [formGroupName]="i">
                <td>
                  <label for="coordenador">Data Início</label>
                  <input type="date" id="dataInicio" formControlName="dataInicio"
                  [ngClass]="{'valid-input': validarEtapaDataFinalPosterior(),
                  'invalid-input': !validarEtapaDataFinalPosterior()}" />

                </td>
                <td >
                  <label for="coordenador">Data Fim</label>
                  <input type="date" id="dataFim" formControlName="dataFim"
                  [ngClass]="{'valid-input': validarEtapaDataFinalPosterior(),
                  'invalid-input': !validarEtapaDataFinalPosterior()}" />
                </td>
                <td>
                  <button class="btn-alert add-step" (click)="removeSteps(i)">
                    Remove
                  </button>
                </td>
            </tr>
          </div>
        </table>
      </div>
      <div class="btn-submit-container">
        <button type="submit" class="btn-register" (click)=submitForm()
        [ngClass]="{'btn-green': isNumeroValid() && isNomeValid() && isAtorValid() && validarDataFinalPosterior() && validarEtapaDataFinalPosterior(),
                    'btn-gray': !(isNumeroValid() && isNomeValid() && isAtorValid() && validarDataFinalPosterior() && validarEtapaDataFinalPosterior())}"
        [disabled]="!(isNumeroValid() && isNomeValid() && isAtorValid() && validarDataFinalPosterior() && validarEtapaDataFinalPosterior())">Enviar</button>
      </div>
  </form>
</div>
